---
title: "wright_2019_replication"
author: "Bj√∂rn Siepe"
date: "`r Sys.Date()`"
output: html_document
---

This document loads data of Wright et al. (2019) from the [Open Science Framework](https://osf.io/95hyr/).
As code was not available online, we then fit a GIMME model with default settings to the data, as suggested by Wright in personal communication.

# Preparation
```{r packages}
library(gimme)
library(tidyverse)
```


# Load Data

```{r load-data}
file_list <- list.files(here::here("data/wright_2019/individual_files"), 
                        full.names = TRUE)
data_list <- lapply(file_list, read.csv)

# Add time variable for possible detrending
data_list <- lapply(data_list, function(x){
  x <- x |> 
    dplyr::mutate(time = dplyr::row_number())
})


saveRDS(data_list, here::here("data/wright_2019/data_list.RDS"))


# Read in data
data_list <- readRDS(here::here("data/wright_2019/data_list.RDS"))

```



# Preprocessing

## Detrending
```{r}
rel_vars <- c("Dominance", "Affiliation", "PosAff",
              "NegAff", "Stress", "Functioning")
data_list_detrend <- list()

# Loop across all participants
for(p in 1:length(data_list)){
  data_list_detrend[[p]] <- fn_detrend(data_list[[p]],
                               vars = rel_vars, 
                               time_var = "time", 
                               sig_only = FALSE)
}

# Delete time variable again
for(p in 1:length(data_list)){
  data_list[[p]] <- subset(data_list[[p]], select = -c(time))
  data_list_detrend[[p]] <- subset(data_list_detrend[[p]], select = -c(time))
}


```



# Fit Model
```{r fit-gimme}
fit <- gimme(
  data = data_list_detrend,
  out = "data/wright_2019/gimme_output",
  ar = TRUE,           
  plot = TRUE,         
  subgroup = TRUE,     
  hybrid = FALSE,      
  groupcutoff = .75,   # unclear
  subcutoff = .50,     # unclear
)


```




# Sanity Check
Compare our results with fitted results online to see if we specified the model in a similar way.